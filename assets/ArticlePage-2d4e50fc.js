import{M as L}from"./index-f5b80f59.js";import{as as V,r as f,aA as I,C as m,K as r,G as o,a7 as g,L as a,E as v,at as x,a9 as M,aj as $,u as k,au as A,M as w,al as N,D as S,S as E,aB as T,ay as B,az as R}from"./index-88ddd4ea.js";import{L as D,N as F,v as H,O as q,P as U,Q as j}from"./PostAPI-ded6fd23.js";import{a as O,E as z}from"./el-form-item-001e8db3.js";import{a as C,E as G}from"./el-button-5150060c.js";import"./_Uint8Array-e2c85964.js";const K={class:"comment-div"},Q={class:"comment-div-h2"},J={__name:"Comment",props:{msg:Object},setup(i){const u=i,e=f({name:"",email:"",comment:""}),c=f(!1),l=async()=>{if(e.value.name===""||e.value.email===""||e.value.comment===""){C({title:"发表评论失败",type:"error",message:"请填写完整信息"});return}F(u.msg.articleId,e.value.name,e.value.email,u.msg.parentId,e.value.comment,I(),t=>{C({title:"发表成功",type:"success",message:t.message}),window.location.reload()},t=>{C({title:"发表评论失败",type:"error",message:t})})};(I()!=null||I()!="")&&D(I(),t=>{e.value.email=t.data.email,e.value.name=t.data.userName,c.value=!0},t=>{});const s=[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],d=[{required:!0,message:"评论不能为空",trigger:"blur"}],y=[{required:!0,message:"昵称不能为空",trigger:"blur"}];return(t,n)=>{const _=H,p=O,h=G,P=z;return m(),r("div",K,[o("h2",Q,"评论"+g(u.msg.parentId),1),a(P,{model:e.value,"label-position":t.left,ref:"commentForm",onSubmit:M(l,["prevent"]),class:"comment-form"},{default:v(()=>[a(p,{label:"昵称：",class:"comment-form-item",prop:"name",rules:y},{default:v(()=>[a(_,{modelValue:e.value.name,"onUpdate:modelValue":n[0]||(n[0]=b=>e.value.name=b),class:"comment-form-item",disabled:c.value},null,8,["modelValue","disabled"])]),_:1}),a(p,{label:"邮箱：",class:"comment-form-item",prop:"email",rules:s},{default:v(()=>[a(_,{modelValue:e.value.email,"onUpdate:modelValue":n[1]||(n[1]=b=>e.value.email=b),class:"comment-form-item",disabled:c.value},null,8,["modelValue","disabled"])]),_:1}),a(p,{label:"评论：",class:"comment-form-item",prop:"comment",rules:d},{default:v(()=>[a(_,{type:"textarea",modelValue:e.value.comment,"onUpdate:modelValue":n[2]||(n[2]=b=>e.value.comment=b),class:"comment-form-item comment-form-textarea"},null,8,["modelValue"])]),_:1}),a(p,{class:"comment-form-item"},{default:v(()=>[a(h,{type:"primary",onClick:l,class:"comment-form-primary"},{default:v(()=>[x("发送评论 ")]),_:1})]),_:1})]),_:1},8,["model","label-position","onSubmit"])])}}},W=V(J,[["__scopeId","data-v-4670ae1b"]]);const X={class:"comment"},Y={class:"comentIten-userName"},Z={class:"comentIten-content"},ee={key:0,class:"replies"},te={__name:"CommentItem",props:{comment:Object},emits:["response"],setup(i,{emit:u}){const e=i,c=async()=>{confirm("确定删除该评论吗？")&&q(e.comment.id,I(),s=>{C({title:"删除成功",type:"success",message:s.message}),window.location.reload()},s=>{C({title:"删除失败",type:"error",message:s})})},l=async()=>{window.scrollTo(0,document.body.scrollHeight),u("response",e.comment.id)};return(s,d)=>{const y=$("CommentItem",!0);return m(),r("div",null,[o("div",X,[o("h5",Y,g(e.comment.userName),1),o("h5",{class:"comentIten-reply",onClick:l},"回复"),o("p",Z,g(e.comment.content),1),o("h5",{class:"comentIten-delete",onClick:c},"删除"),o("small",null,g(k(A)(e.comment.createdAt)),1)]),e.comment.comments.length>0?(m(),r("div",ee,[(m(!0),r(w,null,N(e.comment.comments,(t,n)=>(m(),S(y,{onResponse:d[0]||(d[0]=_=>{e.comment.id=_,u("response",e.comment.id)}),key:n,comment:t},null,8,["comment"]))),128))])):E("",!0)])}}},oe=V(te,[["__scopeId","data-v-f147366f"]]);const se=i=>(B("data-v-ec429ffa"),i=i(),R(),i),ne={key:0,class:"article-content"},ae=["innerHTML"],me={key:1,class:"article-content"},le=["innerHTML"],re={key:2},ce=se(()=>o("h2",null,"评论",-1)),ie={class:"article-contents"},ue={__name:"ArticlePage",props:{},emits:["response"],setup(i,{emit:u}){u("response","文章");const e=T(),c=f(e.params.id),l=f({}),s=f(),d=f({articleId:c.value,parentId:""}),y=new L;return U(c.value,t=>{l.value=t.data},t=>{}),j(c.value,t=>{s.value=t.data},t=>{}),(t,n)=>(m(),r(w,null,[x(" / "+g(k(e).params.id)+" ",1),o("h1",null,g(l.value.title),1),l.value.markdownContent==""?(m(),r("div",ne,[o("div",{innerHTML:l.value.content,class:"markdown-body"},null,8,ae)])):(m(),r("div",me,[o("div",{innerHTML:k(y).render(l.value.markdownContent??""),class:"markdown-body"},null,8,le)])),s.value&&s.value.comments?(m(),r("div",re,[ce,o("div",ie,[(m(!0),r(w,null,N(s.value.comments,(_,p)=>(m(),r("div",{key:p,class:"article-contents-item"},[a(oe,{comment:_,onResponse:n[0]||(n[0]=h=>d.value.parentId=h)},null,8,["comment"])]))),128))])])):E("",!0),a(W,{msg:d.value},null,8,["msg"])],64))}},ye=V(ue,[["__scopeId","data-v-ec429ffa"]]);export{ye as default};
